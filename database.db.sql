BEGIN TRANSACTION;
CREATE TABLE supplies(s_id varchar(20), cycle_name varchar(50), constraint pk_s primary key(s_id,cycle_name),constraint fk1_s foreign key(s_id) references suppliers(s_id) on delete cascade,constraint fk2_s foreign key(cycle_name) references stock(cycle_name) on delete cascade);
INSERT INTO `supplies` VALUES ('3','ALPHA CYCLONE');
INSERT INTO `supplies` VALUES ('2','SUNNY(KIDS)');
INSERT INTO `supplies` VALUES ('2','ROWDY');
INSERT INTO `supplies` VALUES ('2','CHAMP DOODLE(BSA)');
INSERT INTO `supplies` VALUES ('2','BSA DRAKE');
INSERT INTO `supplies` VALUES ('2','LB CLEO(BSA)');
INSERT INTO `supplies` VALUES ('2','MACH CITY BIKE(BSA)');
INSERT INTO `supplies` VALUES ('2','PHOTON EX(BSA)');
INSERT INTO `supplies` VALUES ('2','SUPREME(BSA)');
INSERT INTO `supplies` VALUES ('4','CAPTAIN VIRAT');
INSERT INTO `supplies` VALUES ('5','DNS AURA');
INSERT INTO `supplies` VALUES ('5','DNS ULTRA UTX');
INSERT INTO `supplies` VALUES ('1','EMPRESS(PINK)');
INSERT INTO `supplies` VALUES ('1','EMPRESS PU');
INSERT INTO `supplies` VALUES ('1','FLORAL C/B');
INSERT INTO `supplies` VALUES ('4','TOP GEAR CX70');
INSERT INTO `supplies` VALUES ('1','HERO GUNNER');
INSERT INTO `supplies` VALUES ('1','POWER STAR');
INSERT INTO `supplies` VALUES ('2','SPRINT VYRUS');
INSERT INTO `supplies` VALUES ('1','JET GENTS');
INSERT INTO `supplies` VALUES ('1','BK LADIES');
INSERT INTO `supplies` VALUES ('1','BK BLUE');
INSERT INTO `supplies` VALUES ('2','SUNDANCER');
INSERT INTO `supplies` VALUES ('1','HERO ROTOR');
INSERT INTO `supplies` VALUES ('1','HERO SPRINT');
INSERT INTO `supplies` VALUES ('2','AIYANA');
CREATE TABLE suppliers(s_id varchar(20), s_name varchar(50),s_city varchar(30),ph_no number,email varchar(50), constraint pk_sup primary key(s_id));
INSERT INTO `suppliers` VALUES ('1','HERO','PUNJAB',9875647384,'hero@gmail.com');
INSERT INTO `suppliers` VALUES ('2','BSA','LUDHIANA',9827772837,'bsa@gmail.com');
INSERT INTO `suppliers` VALUES ('3','AVON','MUMBAI',9847363847,'avon@gmail.com');
INSERT INTO `suppliers` VALUES ('4','HERCULES','AMRITSAR',9877389283,'hercules@gmail.com');
INSERT INTO `suppliers` VALUES ('5','BHOGAL','PUNJAB',8937267363,'bhogal@gmail.com');
CREATE TABLE stock(cycle_name varchar(50),cat_id varchar(10),cost_price number, sell_price number, cycle_image varchar(100),quantity number, description text, constraint pk_stock primary key(cycle_name),constraint fk_stock foreign key(cat_id) references category(cat_id) on delete cascade);
INSERT INTO `stock` VALUES ('AIYANA','2',2900,4106.4,'aiyana.png',2,'age: 16+');
INSERT INTO `stock` VALUES ('SUNNY(KIDS)','3',1400,1982.4,'baby14.jpg',3,'age: 8+');
INSERT INTO `stock` VALUES ('ROWDY','3',1700,2407.2,'rowdy.jpg',3,'age: 9+');
INSERT INTO `stock` VALUES ('CHAMP DOODLE(BSA)','3',2600,3681.6,'champ_doodle.png',3,'age: 9+');
INSERT INTO `stock` VALUES ('BSA DRAKE','3',2500,3540,'bsa_drake.jpeg',3,'age: 14+');
INSERT INTO `stock` VALUES ('LB CLEO(BSA)','2',3400,4814.4,'BSA_Ladybird_Cleo_Pink_2018_05.jpg',2,'age: 16+');
INSERT INTO `stock` VALUES ('MACH CITY BIKE(BSA)','1',5000,7080,'BSA_BSA_Mach_City__6014.jpg',2,'age: 16+');
INSERT INTO `stock` VALUES ('PHOTON EX(BSA)','1',3400,4814.4,'bsa_photon.jpeg',3,'age: 16+');
INSERT INTO `stock` VALUES ('SUPREME(BSA)','1',3000,4248,'bsa_supreme.jpg',3,'age: 16+');
INSERT INTO `stock` VALUES ('CAPTAIN VIRAT','1',3200,4531.2,'virat_hercules.png',2,'age: 16+');
INSERT INTO `stock` VALUES ('DNS AURA','2',3200,4531.2,'dns_aura.jpg',1,'age: 16+');
INSERT INTO `stock` VALUES ('DNS ULTRA UTX','1',2800,3964.8,'dns_ultra.jpg',2,'age: 16+');
INSERT INTO `stock` VALUES ('EMPRESS(PINK)','2',2900,4106.4,'empress_pink.jpg',2,'age: 16+');
INSERT INTO `stock` VALUES ('EMPRESS PU','2',3000,4248,'hero_empress.png',1,'age: 16+');
INSERT INTO `stock` VALUES ('FLORAL C/B','2',3000,4248,'floral_cb.jpeg',2,'age: 16+');
INSERT INTO `stock` VALUES ('TOP GEAR CX70','1',6000,8496,'HERCULES_TOPGEAR.jpg',1,'age: 16+');
INSERT INTO `stock` VALUES ('HERO GUNNER','1',3200,4531.2,'gunner.png',3,'age: 16+');
INSERT INTO `stock` VALUES ('POWER STAR','1',3000,4248,'powerStar.png',2,'age: 18+');
INSERT INTO `stock` VALUES ('SPRINT VYRUS','1',3300,4672.8,'HERO_SPRINT.png',1,'age: 16+');
INSERT INTO `stock` VALUES ('JET GENTS','1',2500,3540,'BK_GENTS.png',3,'age: 18+');
INSERT INTO `stock` VALUES ('BK LADIES','2',2500,3540,'BK_LADIES.jpg',3,'age: 16+');
INSERT INTO `stock` VALUES ('BK BLUE','2',2500,3540,'BK_BLUE.jpg',2,'age: 16+');
INSERT INTO `stock` VALUES ('SUNDANCER','3',2500,3540,'sundancer.png',2,'age: 8+');
INSERT INTO `stock` VALUES ('HERO ROTOR','3',2000,2832,'rotor.jpg',2,'age: 8+');
INSERT INTO `stock` VALUES ('HERO SPRINT','3',2700,3823.2,'SPRINT_KIDS.jpeg',1,'age: 8+');
CREATE TABLE enquiry(enq_id varchar(100), user_id varchar(20), cycle_name varchar(50), cat_id varchar(10),enq_date date, constraint pk_enq primary key(enq_id,user_id,cycle_name,cat_id), constraint fk1_enq foreign key(user_id) references customer(user_id) on delete set null,constraint fk2_enq foreign key(cycle_name) references stock(cycle_name) on delete set null,constraint fk3_enq foreign key(cat_id) references category(cat_id) on delete set null);
INSERT INTO `enquiry` VALUES ('<generator object uniqueid at 0x7f9f130a96d8>','ankit','PHOTON EX(BSA)','1','2018-11-26');
INSERT INTO `enquiry` VALUES ('<generator object uniqueid at 0x7f9f130a9570>','ankit','SUPREME(BSA)','1','2018-11-26');
INSERT INTO `enquiry` VALUES ('<generator object uniqueid at 0x7f9f130a91b0>','ankit','CHAMP DOODLE(BSA)','3','2018-11-26');
INSERT INTO `enquiry` VALUES ('<generator object uniqueid at 0x7f9c5042d408>','ankit','MACH CITY BIKE(BSA)','1','2018-11-26');
INSERT INTO `enquiry` VALUES ('<generator object uniqueid at 0x7f6d6a4abc78>','ankit','TOP GEAR CX70','1','2018-11-26');
INSERT INTO `enquiry` VALUES ('<generator object uniqueid at 0x7f1f74d06e58>','ankit','BSA DRAKE','3','2018-11-27');
CREATE TABLE customer(user_id varchar(20), password varchar(30), name varchar(50), ph_no number, constraint pk_cus primary key(user_id));
INSERT INTO `customer` VALUES ('ankit','ankit1234','Ankit Kashyap',80933);
INSERT INTO `customer` VALUES ('praveen','praveen1234','Praveen K B',99999);
INSERT INTO `customer` VALUES ('vaibhav','vaibhav1234','vaibhav',687678687);
CREATE TABLE category(cat_id varchar(10), cat_name varchar(15),constraint pk_cat primary key(cat_id));
INSERT INTO `category` VALUES ('1','boys');
INSERT INTO `category` VALUES ('2','girls');
INSERT INTO `category` VALUES ('3','kids');
CREATE TABLE access(user_id varchar(20), cycle_name varchar(50), constraint pk_acc primary key(user_id,cycle_name), constraint fk1_acc foreign key(user_id) references customer(user_id) on delete cascade,constraint fk2_acc foreign key(cycle_name) references stock(cycle_name) on delete cascade);
CREATE TRIGGER calculate_sp_update after update on stock for each row begin update stock set sell_price = new.cost_price*1.18*1.2 where cycle_name = new.cycle_name; end;
CREATE TRIGGER calculate_sp after insert on stock for each row begin update stock set sell_price = new.cost_price*1.18*1.2 where cycle_name = new.cycle_name; end;
COMMIT;
